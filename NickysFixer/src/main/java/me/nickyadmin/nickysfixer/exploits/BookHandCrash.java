package me.nickyadmin.nickysfixer.exploits;

import me.nickyadmin.nickysfixer.Main;
import org.bukkit.ChatColor;
import org.bukkit.Material;
import org.bukkit.configuration.file.FileConfiguration;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.player.PlayerSwapHandItemsEvent;
import org.bukkit.inventory.ItemStack;

public class BookHandCrash implements Listener {
        private final Main plugin;

        public BookHandCrash(Main plugin) {
            this.plugin = plugin;
        }

        @EventHandler
        public void PlayerHandBookSwap(PlayerSwapHandItemsEvent event) {
            Player p = event.getPlayer();
            FileConfiguration config = plugin.getConfig();
            if (config.getBoolean("fix-book-hand-crash")) {
                ItemStack item = event.getOffHandItem();
                       if (!p.hasPermission("nickysfixer.bookcrash.bypass")
                               && item.getType() == Material.WRITTEN_BOOK
                               || item.getType() == Material.BLACK_SHULKER_BOX
                               || item.getType() == Material.BLUE_SHULKER_BOX
                               || item.getType() == Material.GREEN_SHULKER_BOX
                               || item.getType() == Material.CYAN_SHULKER_BOX
                               || item.getType() == Material.GRAY_SHULKER_BOX
                               || item.getType() == Material.LIGHT_BLUE_SHULKER_BOX
                               || item.getType() == Material.LIME_SHULKER_BOX
                               || item.getType() == Material.MAGENTA_SHULKER_BOX
                               || item.getType() == Material.ORANGE_SHULKER_BOX
                               || item.getType() == Material.PINK_SHULKER_BOX
                               || item.getType() == Material.PURPLE_SHULKER_BOX
                               || item.getType() == Material.RED_SHULKER_BOX
                               || item.getType() == Material.SILVER_SHULKER_BOX
                               || item.getType() == Material.WHITE_SHULKER_BOX
                               || item.getType() == Material.YELLOW_SHULKER_BOX) {
                           if (config.getBoolean("fix-book-hand-crash-message")) {
                               p.sendMessage(ChatColor.DARK_RED + "[NickysFixer] " + ChatColor.DARK_AQUA + "data swapping is disabled due to an exploit ;p");

                           }
                           event.setCancelled(true);
                       }
        }
    }
}
